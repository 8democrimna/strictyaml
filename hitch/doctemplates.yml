story: |
  {{ story.name }}
  {{ "=" * story.name|length }}

  {{ story.info['description'] }}
  
  {% if 'yaml_snippet' in story.given %}Example yaml_snippet:
  
  ``` {.sourceCode .yaml}

      {{ story.given['yaml_snippet']|indent(4) }}
  ```
  {% endif %}
  
  {% if 'setup' in story.given %}``` {.sourceCode .yaml}
  
      {{ story.given['setup']|indent(4) }}
  {% endif %}

  {% for variation in story.variations %}
  
  {{ variation.child_name }}
  {{ "-" * variation.child_name|length }}
  
  {{ variation.steps[0].documentation() }}
  {% endfor %}

  Page automatically generated from executable user story:
    https://github.com/crdoconnor/strictyaml/blob/master/hitch/{{ story.filename.basename() }}

readme: |
  {{ story.name }}:
  {% if 'yaml_snippet' in story.given %}
  ``` {.sourceCode .yaml}

  {{ story.given['yaml_snippet'] }}
  ```
  {% endif %}

  {% for variation in story.variations %}
  
  {{ variation.child_name }}:
  
  {{ variation.steps[0].documentation() }}
  {% endfor %}

run: |
  {% if step['in_interpreter'] %}
  ```python
  
  {% for line in step['code'].rstrip('\n').split('\n') %}>>> {{ line }}
  {% endfor -%}
  {{ step['will_output'] }}
  ```
  {% else %}
  ```python
  
  {{ step['code'] }}
  ```
  {% if 'will_output' in step %}
  ```yaml
  {{ step['will_output'] }}
  ```
  {% endif %}
  {% if 'raises' in step %}
  ```
  {% if 'in python 3' in step['raises']['type'] -%}
  {{ step['raises']['type']['in python 3'] }}:
  {%- else %}{{ step['raises']['type'] }}:{% endif -%}
  {%- if 'in python 3' in step['raises']['message'] -%}
  {{ step['raises']['message']['in python 3']  }}:
  {% else %}
  {{ step['raises']['message'] }}
  {% endif %}
  {% endif %}
  {% endif %}
